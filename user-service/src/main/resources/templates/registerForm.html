<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>


<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css"/>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js" integrity="sha512-XtmMtDEcNz2j7ekrtHvOVR4iwwaD6o/FUJe6+Zq+HgcCsk3kj4uSQQR8weQ2QVj1o0Pk6PwYLohm206ZzNfubg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


<script>
    function sendRegistration(){

        // var token = $("meta[name='_csrf']").attr("content");
        // var header = $("meta[name='_csrf_header']").attr("content");

        var paramData = {
            email : document.getElementById("email").value,
            name : document.getElementById("name").value,
            pwd : document.getElementById("password").value
        };

        var param = JSON.stringify(paramData);

        $.ajax({
            url      : "/user-service/users",
            type     : "POST",
            contentType : "application/json",
            data     : param,
            // beforeSend : function(xhr){
            //     /* 데이터를 전송하기 전에 헤더에 csrf값을 설정 */
            //     xhr.setRequestHeader(header, token);
            // },
            dataType : "json",
            cache   : false,
            success  : function(result, status, data){

                console.log("data : "+data);
                console.log("result :  " +result);
                console.log("result.code : "+result.code);
                console.log("result.status : "+result.status);
                // console.log("result.errorMap.name.rejectValue: "+result.errorMap.name.rejectValue);

                console.log('status :' + status);

                if (result.code == '400') {
                    console.log('---------400--------')

                    if (result.errorMap.name !== undefined) {
                        console.log("result.errorMap.name.message: "+result.errorMap.name.message);
                        alert(result.errorMap.name.message);
                    }

                    if (result.errorMap.email !== undefined) {
                        console.log("result.errorMap.email.message: "+result.errorMap.email.message);
                        alert(result.errorMap.email.message);
                    }

                    if (result.errorMap.pwd !== undefined) {
                        console.log("result.errorMap.pwd.message: "+result.errorMap.pwd.message);
                        alert(result.errorMap.pwd.message);
                    }


                    // 2~3 개 필드가 동시에 에러가 나면 0번째를 가져오면 안됨
                    // 그러면 message 를 list 가 아니라 map 으로 가져와야 하나 ?
                    // var commentError = document.getElementById("commentError");
                    // commentError.innerText = result.messageList[0];
                }


                if(result.status === undefined){

                    alert("가입이 성공되었습니다.");
                    location.href='/game-service/main';
                }

            },
            error : function(jqXHR, status, error, request){

                //에러를 반환하면 여기로 옴
                // console.log(jqXHR.status+"\n"+jqXHR.responseText+"\n"+error)
                console.log(jqXHR.responseText);


                // alert(jqXHR.status+"\n"+jqXHR.responseText+"\n"+error);
                alert(jqXHR.responseText);


            }
        });
    }

    function getLoginForm(){

        location.href="/user-service/loginForm"
    }
</script>

<style>
    /*@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;500;600;700&display=swap');*/

    /**{*/
    /*    margin: 0;*/
    /*    padding: 0;*/
    /*    box-sizing: border-box;*/
    /*    font-family: 'Poppins',sans-serif;*/
    /*}*/
    #main-container{
        background-color: rgb(36, 29, 24);
        width: 100%;
        height: 100vh;
        padding: 200px;
    }

    #navbar{
        position: fixed;
        z-index: 100;
        width: 200px;
        background-color: rgba(95, 56, 39);
        right:0;
        height: 80px;
    }

    #SignInBtnBox{
        width: 100px;
    }

    #navTextBox{
        width: 300px;
    }

    .navbar-container{
        display: flex;
    }

    .nav-text{
        margin-top: 10px;
        margin-left: 20px;
        font-size: 20px;
        color: rgb(249, 238, 222);
    }

    .navBtn-text{
        margin-top: 4px;
        color: rgb(249, 238, 222);
        font-size: 30px;

    }

    .nav-item{
        margin-top: 10px;
        margin-right: 10px;

        width: 400px;
    }


    .navbarBtn{
        border: none;              /* 모든 테두리를 초기화 */
        background: none;           /* 배경 없애기 */
        padding-left: 10px;                 /* 기본 여백 없애기 (선택 사항) */
        outline: none;              /* 클릭 시 외곽선 없애기 (선택 사항) */
        cursor: pointer;            /* 클릭 가능한 느낌 유지 */
        margin-left: 20px;
        margin-right: 20px;
        width: 150px;
        height: 50px;
        color: white;
    }


    .navbar-divider{

        border-left: 4px solid rgb(249, 238, 222); /* 왼쪽 테두리만 설정 */
    }
    .navbar-text{
        padding:0;
        color: white;
        font-size: 30px;
    }




    #container{
        margin-top: 50px;
        margin-left: 200px;
        margin-right: 200px;
    }

    .title{
        height: 120px;
        font-size: 40px;
        color: rgb(249, 238, 222);

        display: flex;
        justify-content: center;
        align-items: center;
    }

    #title-text{
        font-size: 60px;
        color: rgb(249, 238, 222);
    }

    .center-box{
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    #userIconBox{
        width: 130px; /* 원의 가로 크기 */
        height: 130px; /* 원의 세로 크기 */
        border-radius: 50%; /* 원형으로 만들기 */
        overflow: hidden; /* 원 밖으로 튀어나오는 것 숨기기 */
        background-color: rgb(36, 29, 24); /* 배경색 */


        display: flex;
        align-items: center;
        justify-content: center;

        border: 5px solid rgb(249, 238, 222);
    }

    #userIcon{
        margin-top: 20px;
        font-size: 100px;
        color: rgb(249, 238, 222);
    }

    .input-container {
        position: relative;
        display: inline-block;
    }

    .input-container i {
        position: absolute;
        top: 50%;
        left: 5px;
        transform: translateY(-50%);
        color: rgb(56, 54, 50);
        margin-left: 30px;
    }

    .input-container input {
        padding-left: 70px; /* 아이콘 공간 확보 */
        background-color: rgb(159, 152, 142);
        color: rgb(56, 54, 50);
        border-radius: 50px;
        border: 3px solid rgba(95, 56, 39); /* 테두리 두께는 4px, 색상은 갈색 */
        width: 100%;
        height: 60px;

        font-size: 15px;
    }

    input::placeholder {
        color: rgb(56, 54, 50); /* 원하는 색상 코드 */
        opacity: 1; /* 일부 브라우저에서 투명도를 조정할 수 있습니다 */
    }

    .input-icon{
        font-size: 30px;
    }

    #email{
        color: rgb(56, 54, 50);
    }

    #submitBtn{
        background-color: rgba(95, 56, 39);
        color: rgb(249, 238, 222);
        border-radius: 50px;
        border: 3px solid rgba(95, 56, 39); /* 테두리 두께는 4px, 색상은 갈색 */
        width: 100%;
        height: 60px;

        font-size: 30px;

        margin-bottom: 20px;
    }


</style>

<body>
<div id="navbar">
    <div class="navbar-container">
        <div id="SignInBtnBox" class="nav-item">
            <button id="registerFormBtn" class="navbarBtn" onclick="getLoginForm()"><p class="navBtn-text">LOGIN</p></button>
        </div>
    </div>
</div>
<div id="main-container">
    <div id="container">
        <div class="title">
            <span id="title-text">CREATE NEW ACCOUNT</span>
        </div>

        <div class="row mb-3">
            <div class="input-container">
                <i class="fas fa-user input-icon"></i>
                <input id="name" type="text" placeholder="name" required>
            </div>
        </div>
        <div class="row mb-3">
            <div class="input-container">
                <i class="fas fa-envelope input-icon"></i>
                <input id="email" type="text" placeholder="Email" required>
            </div>
        </div>
        <div class="row mb-3">
            <div class="input-container">
                <i class="fas fa-lock input-icon"></i>
                <input id="password" type="password" placeholder="password" required>
            </div>
        </div>
        <button id="submitBtn" onclick="sendRegistration()">SIGN IN</button>
    </div>
</div>

<footer id="footer">
    <div class="section-content">
        <div id="footer-container">


        </div>
    </div>
</footer>

</body>
</html>